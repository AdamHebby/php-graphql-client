# php-graphql-client
A GraphQL client written in PHP that generates schema objects based on the types being dealt with using the
introspection feature in GraphQL API's. The package also provides a very simple, yet powerful, query generator class
which makes writing GraphQL queries a very simple process.

# Query Example
```
$gql = (new Query('Company'))
    ->setArguments(['filter' => '{name_contains: "XD"}', 'first' => 3])
    ->setSelectionSet(
        [
            'name',
            (new Query('branches'))
                ->setArguments(['first' => 1])
                ->setSelectionSet(
                    [
                        'address',
                        (new Query('contracts'))
                            ->setArguments(['first' => 3])
                            ->setSelectionSet(['date'])
                    ]
                )
        ]
    );
```
Running query with the GraphQL client and getting the results in object structure:
```
$results = $client->runQuery($gql);
$results->getData()->Company[0]->branches;
```
Or getting results in array structure:
```
$results = $client->runQuery($gql, true);
$results->getData()['Company'][1]['branches']['address']
```

# Generating The Schema Objects (Beta)
Schema objects can easily be generated by executing the command:
```
bin/build_schema
```
 This script will generate the schema objects from your API's schema types and save them in the `schema_object` directory
 in the root directory of the package.
 
 # The Schema Object Classes
 The schema scanner will generate to classes for each query type in the schema:
 - {TypeName}Trait: Contains the fields in defined in the query type
 - {TypeName}QueryObject: Contains the setter methods to set arguments and select methods to add a field to the selection set of the query
 
 Example:
 
 TestTrait:
 ```
 trait TestTrait
 {
     protected $property_one;
     protected $propertyTwo;
 }

```
 
 TestQueryObject:
 ```
 class TestQueryObject extends QueryObject
 {
     use TestTrait;
 
     const OBJECT_NAME = 'Test';
 
     public function setPropertyOne($propertyOne)
     {
         $this->property_one = $propertyOne;
     
         return $this;
     }
 
     public function selectPropertyOne()
     {
         $this->selectField('property_one');
     
         return $this;
     }
 
     public function setPropertyTwo($propertyTwo)
     {
         $this->propertyTwo = $propertyTwo;
     
         return $this;
     }
 
     public function selectPropertyTwo()
     {
         $this->selectField('propertyTwo');
     
         return $this;
     }
 
     public function selectOtherObjects()
     {
         $object = new OtherObjectQueryObject('other_objects');
         $this->selectField($object);
     
         return $object;
     }
 }

``` 
 
 # Using The Object 
 
 ```
$testQuery = new TestQueryObject();
$testQuery->selectPropertyTwo()->setFirst(10)->setPropertyOne('some_value');
$testQuery->selectOtherObjects()->selectName()->setFirst(5);

print $testQuery->getQueryString();
```
Results in the following query string:
```
query {
Test(first: 10 property_one: "some_value") {
propertyTwo
other_objects(first: 5) {
name
}
}
}
```

The query object can be easily run by using the GraphQL client:
```
$client->runQueryObject($testQuery);
```

# Supported Feature
- Query builder
- Generating schema objects from API types (Beta)
- Using schema objects to build queries
- Results parsing in multiple formats
- Reporting API errors

# Feature on-Track
- Mutation types
- Query and field aliases
- Fragment types
